<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension-point id="carisma.ui.eclipse.editor.description" name="EditorDescription" schema="schema/carisma.ui.eclipse.editor.description.exsd"/>
   <extension-point id="carisma.ui.eclipse.analysis.popup.menu" name="AnalysisPopupMenu" schema="schema/carisma.ui.eclipse.analysis.popup.menu.exsd"/>
	
	<extension point="org.eclipse.ui.newWizards">
      <category
            id="carisma.ui.eclipse.Wizard"
            name="CARiSMA"/>
      <wizard
            category="carisma.ui.eclipse.Wizard"
            class="carisma.ui.eclipse.editors.AdfModelWizard"
            icon="icons/Logo16x16.png"
            id="carisma.ui.eclipse.editors.AdfModelWizardID"
            name="Analysis">
         <description>Create a new CARiSMA Analysis</description>
         <selection class="org.eclipse.core.resources.IResource"/>
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <category
            name="CARiSMA"
            id="carisma.ui.eclipse">
      </category>
      <view
            category="carisma.ui.eclipse"
            class="carisma.ui.eclipse.views.AnalysisResultsView"
            icon="icons/Logo16x16.png"
            id="carisma.ui.eclipse.views.AnalysisResultsView"
            name="Analysis Results">
      </view>
      <view
            allowMultiple="false"
            category="carisma.ui.eclipse"
            class="org.eclipse.ui.views.navigator.ResourceNavigator"
            id="org.eclipse.ui.views.navigator.ResourceNavigator"
            name="Resource Navigator"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.help.contexts">
      <contexts
            file="contexts.xml"
            plugin="carisma.ui.eclipse">
      </contexts>
   </extension>
    <extension
          point="org.eclipse.help.toc">
       <toc
             file="help/toc.xml"
             primary="true">
       </toc>
       <toc
             file="help/tocuserguide.xml"
             primary="false">
       </toc>
       <toc
             file="help/tocdeveloperguide.xml"
             primary="false">
       </toc>
       <toc
             file="help/tocchecks.xml"
             primary="false">
       </toc>
    </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.eclipse.jdt.ui.JavaPerspective">
         <view
               id="carisma.ui.eclipse.views.AnalysisResultsView"
               ratio="0.5"
               relationship="right"
               relative="org.eclipse.ui.views.TaskList">
         </view>
      </perspectiveExtension>
      <perspectiveExtension
            targetID="*">
         <newWizardShortcut
               id="carisma.ui.eclipse.editors.AdfModelWizardID">
         </newWizardShortcut>
      </perspectiveExtension>
   </extension>
    <extension
         point="org.eclipse.ui.editors">
      <editor
            name="ADF Editor"
            extensions="adf"
            icon="icons/Logo16x16.png"
            class="carisma.ui.eclipse.editors.AdfEditor"
            id="carisma.ui.eclipse.editors.AdfEditor">
      </editor>
   </extension>
    <extension
          point="org.eclipse.ui.preferencePages">
       <page
             class="carisma.ui.eclipse.preferences.pages.Carisma_index"
             id="carisma.ui.eclipse.index"
             name="CARiSMA">
       </page>
    </extension>
    <extension
          point="org.eclipse.ui.perspectives">
       <perspective
             class="carisma.ui.eclipse.Perspective"
             fixed="false"
             icon="icons/Logo16x16.png"
             id="carisma.perspective"
             name="CARiSMA">
       </perspective>
    </extension>
    <extension
          id="carisma.ui.eclipse.product"
          point="org.eclipse.core.runtime.products">
       <product
             application="carisma.ui.eclipse.coreapp"
             name="CARiSMA Product">
          <property
                name="appName"
                value="CARiSMA Product">
          </property>
          <property
                name="windowImages"
                value="icons/Logo16x16.png">
          </property>
          <property
                name="aboutImage"
                value="help/html/images/about.png">
          </property>
          <property
                name="aboutText"
                value="http://carisma.umlsec.de">
          </property>
       </product>
    </extension>
    <extension
          id="carisma.ui.eclipse.coreapp"
          point="org.eclipse.core.runtime.applications">
       <application
             cardinality="singleton-global"
             thread="main"
             visible="true">
          <run
                class="carisma.ui.eclipse.rcp.Application">
          </run>
       </application>
    </extension>
    <extension
          point="org.eclipse.ui.menus">
          <menuContribution
             locationURI="menu:org.eclipse.ui.main.menu?after=additions">
          <menu
                id="carisma.ui.eclipse.menu.file"
                label="File">
             <command
                   commandId="org.eclipse.ui.newWizard">
             </command>
             <command
                   commandId="org.eclipse.ui.edit.text.openLocalFile">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator1"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.file.close">
             </command>
             <command
                   commandId="org.eclipse.ui.file.closeAll">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator2"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.file.save">
             </command>
             <command
                   commandId="org.eclipse.ui.file.saveAs">
             </command>
             <command
                   commandId="org.eclipse.ui.file.saveAll">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator3"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.file.import">
             </command>
             <command
                   commandId="org.eclipse.ui.file.export">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator4"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.file.exit">
             </command>
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="activeWorkbenchWindow.activePerspective">
                   <equals
                         value="carisma.perspective">
                   </equals>
                   <or>
                      <systemTest
                            property="eclipse.product"
                            value="carisma.ui.eclipse.product">
                      </systemTest>
                   </or>
                </with>
             </visibleWhen>
          </menu>
          <menu
                id="carisma.ui.eclipse.menu.window"
                label="Window">
             <command
                   commandId="org.eclipse.ui.views.showView">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator5"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.window.preferences">
             </command>
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="activeWorkbenchWindow.activePerspective">
                   <equals
                         value="carisma.perspective">
                   </equals>
                   <or>
                      <systemTest
                            property="eclipse.product"
                            value="carisma.ui.eclipse.product">
                      </systemTest>
                   </or>
                </with>
             </visibleWhen>
          </menu>
          <menu
                id="carisma.ui.eclipse.menu.help"
                label="Help">
             <command
                   commandId="org.eclipse.equinox.p2.ui.sdk.install">
             </command>
             <command
                   commandId="org.eclipse.ui.help.installationDialog">
             </command>
             <separator
                   name="carisma.ui.eclipse.separator6"
                   visible="true">
             </separator>
             <command
                   commandId="org.eclipse.ui.help.helpContents">
             </command>
             <command
                   commandId="org.eclipse.ui.help.aboutAction">
             </command>
             <visibleWhen
                   checkEnabled="false">
                <or>
                   <with
                         variable="activeWorkbenchWindow.activePerspective">
                      <equals
                            value="carisma.perspective">
                      </equals>
                   </with>
                   <systemTest
                         property="eclipse.product"
                         value="carisma.ui.eclipse.product">
                   </systemTest>
                </or>
             </visibleWhen>
          </menu>
       </menuContribution>
          <menuContribution
                locationURI="menu:org.eclipse.ui.main.menu?after=carisma.ui.eclipse.menu.file">
             <menu
                   id="carisma.ui.eclipse.menu.carisma"
                   label="CARiSMA">
                <menu
                      id="carisma.ui.eclipse.menu.carisma.regulatory"
                      label="Regulatory">
                </menu>
                <command
                      commandId="carisma.ui.eclipse.opencarisma"
                      icon="icons/Logo16x16.png"
                      label="CARiSMA Perspective"
                      style="push">
                   <visibleWhen
                         checkEnabled="false">
                      <with
                            variable="activeWorkbenchWindow.activePerspective">
                         <not>
                            <equals
                                  value="carisma.perspective">
                            </equals>
                         </not>
                      </with>
                   </visibleWhen>
                </command>
             </menu>
          </menuContribution>
                 <menuContribution
                       locationURI="popup:org.eclipse.ui.popup.any">
                    <menu
                          id="carisma.ui.eclipse.menu1"
                          label="CARiSMA">
                       <command
                             commandId="carisma.ui.eclipse.forgetsavededitor">
                          <visibleWhen
                                checkEnabled="false">
                             <with
                                   variable="selection">
                                <iterate
                                      ifEmpty="false"
                                      operator="or">
                                   <test
                                         property="org.eclipse.core.resources.extension"
                                         value="adf">
                                   </test>
                                </iterate>
                             </with>
                          </visibleWhen>
                       </command>
                       <visibleWhen
                             checkEnabled="false">
                          <or>
                             <with
                                   variable="selection">
                                <or>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="adf">
                                      </test>
                                   </iterate>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="uml">
                                      </test>
                                   </iterate>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="txt">
                                      </test>
                                   </iterate>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="bpmn2">
                                      </test>
                                   </iterate>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="bpmn">
                                      </test>
                                   </iterate>
                                   <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="owl">
                                      </test>
                                   </iterate>
                                </or>
                             </with>
                          </or>
                       </visibleWhen>
                       <command
                             commandId="carisma.ui.eclipse.runanalysisaction">
                          <visibleWhen
                                checkEnabled="false">
                             <with
                                   variable="selection">
                                <iterate
                                      ifEmpty="false"
                                      operator="or">
                                   <test
                                         property="org.eclipse.core.resources.extension"
                                         value="adf">
                                   </test>
                                </iterate>
                             </with>
                          </visibleWhen>
                       </command>
                       <command
                             commandId="carisma.ui.eclipse.CreateAnalysisAction1">
                          <visibleWhen
                                checkEnabled="false">
                             <with
                                   variable="selection">
                                <and>
                                   <count
                                         value="1">
                                   </count>
                                   <or>
                                      <iterate
                                            ifEmpty="false"
                                            operator="or">
                                         <test
                                               property="org.eclipse.core.resources.extension"
                                               value="uml">
                                         </test>
                                      </iterate>
                                      <iterate
                                            ifEmpty="false"
                                            operator="or">
                                         <test
                                               property="org.eclipse.core.resources.extension"
                                               value="bpmn2">
                                         </test>
                                      </iterate>
                                      <iterate
                                            ifEmpty="false"
                                            operator="or">
                                         <test
                                               property="org.eclipse.core.resources.extension"
                                               value="bpmn">
                                         </test>
                                      </iterate>
                                      <iterate
                                         ifEmpty="false"
                                         operator="or">
                                      <test
                                            property="org.eclipse.core.resources.extension"
                                            value="owl">
                                      </test>
                                   </iterate>
                                   </or>
                                </and>
                             </with>
                          </visibleWhen>
                       </command>
                       <separator
                             name="carisma.ui.contextseperator"
                             visible="true">
                       </separator>
                       <command
                             commandId="carisma.ui.eclipse.menuContribution.carisma.openmodel.other">
                          <visibleWhen
                                checkEnabled="false">
                             <with
                                   variable="selection">
                                <iterate
                                      ifEmpty="false"
                                      operator="or">
                                   <test
                                         property="org.eclipse.core.resources.extension"
                                         value="adf">
                                   </test>
                                </iterate>
                             </with>
                          </visibleWhen>
                       </command>
                       <command
                             commandId="carisma.ui.eclipse.menuContribution.carisma.openmodelwith.other">
                          <visibleWhen
                                checkEnabled="false">
                             <with
                                   variable="selection">
                                <iterate
                                      ifEmpty="false"
                                      operator="or">
                                   <test
                                         property="org.eclipse.core.resources.extension"
                                         value="adf">
                                   </test>
                                </iterate>
                             </with>
                          </visibleWhen>
                       </command>
                    </menu>
                 </menuContribution>
    </extension>
      <extension
          point="org.eclipse.ui.commands">
       <command
             id="carisma.ui.eclipse.runanalysisaction"
             name="Run analysis">
       </command>
       <command
             id="carisma.ui.eclipse.menuContribution.carisma.openmodel.other"
             name="Open model">
       </command>
       <command
             id="carisma.ui.eclipse.menuContribution.carisma.openmodelwith.other"
             name="Open model with">
       </command>
       <command
             id="carisma.ui.eclipse.forgetsavededitor"
             name="Clear selected editor">
       </command>
       <command
             id="carisma.ui.eclipse.CreateAnalysisAction1"
             name="Create Analysis File">
       </command>
       <command
             id="carisma.ui.eclipse.opencarisma"
             name="Open Carisma Perspective">
       </command>
    </extension>
      <extension
            point="org.eclipse.ui.handlers">
         <handler
               class="carisma.ui.eclipse.rcp.RunAnalysisEditorHandler"
               commandId="carisma.ui.eclipse.runanalysisaction">
            <activeWhen>
               <and>
                  <with
                        variable="activePartId">
                     <equals
                           value="carisma.ui.eclipse.editors.AdfEditor">
                     </equals>
                  </with>
                  <with
                        variable="activeEditorInput">
                     <adapt
                           type="org.eclipse.core.resources.IFile">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </adapt>
                  </with>
               </and>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.RunAnalysisNavigatorHandler"
               commandId="carisma.ui.eclipse.runanalysisaction">
            <activeWhen>
               <with
                     variable="selection">
                  <and>
                     <iterate
                           operator="and">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </iterate>
                     <count
                           value="1">
                     </count>
                  </and>
               </with>
               </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.OpenModelEditorHandler"
               commandId="carisma.ui.eclipse.menuContribution.carisma.openmodel.other">
            <activeWhen>
               <and>
                  <with
                        variable="activePartId">
                     <equals
                           value="carisma.ui.eclipse.editors.AdfEditor">
                     </equals>
                  </with>
                  <with
                        variable="activeEditorInput">
                     <adapt
                           type="org.eclipse.core.resources.IFile">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </adapt>
                  </with>
               </and>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.OpenModelNavigatorHandler"
               commandId="carisma.ui.eclipse.menuContribution.carisma.openmodel.other">
            <activeWhen>
               <with
                     variable="selection">
                  <and>
                     <iterate
                           operator="and">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </iterate>
                     <count
                           value="1">
                     </count>
                  </and>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.OpenModelWithEditorHandler"
               commandId="carisma.ui.eclipse.menuContribution.carisma.openmodelwith.other">
            <activeWhen>
               <and>
                  <with
                        variable="activePartId">
                     <equals
                           value="carisma.ui.eclipse.editors.AdfEditor">
                     </equals>
                  </with>
                  <with
                        variable="activeEditorInput">
                     <adapt
                           type="org.eclipse.core.resources.IFile">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </adapt>
                  </with>
               </and>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.OpenModelWithNavigatorHandler"
               commandId="carisma.ui.eclipse.menuContribution.carisma.openmodelwith.other">
            <activeWhen>
               <with
                     variable="selection">
                  <and>
                     <iterate
                           operator="and">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </iterate>
                     <count
                           value="1">
                     </count>
                  </and>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.ForgetEditorEditorHandler"
               commandId="carisma.ui.eclipse.forgetsavededitor">
            <activeWhen>
               <and>
                  <with
                        variable="activePartId">
                     <equals
                           value="carisma.ui.eclipse.editors.AdfEditor">
                     </equals>
                  </with>
                  <with
                        variable="activeEditorInput">
                     <adapt
                           type="org.eclipse.core.resources.IFile">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </adapt>
                  </with>
               </and>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.ForgetEditorNavigatorHandler"
               commandId="carisma.ui.eclipse.forgetsavededitor">
            <activeWhen>
               <with
                     variable="selection">
                  <and>
                     <iterate
                           operator="and">
                        <test
                              property="org.eclipse.core.resources.extension"
                              value="adf">
                        </test>
                     </iterate>
                     <count
                           value="1">
                     </count>
                  </and>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.CreateAnalysisHandler"
               commandId="carisma.ui.eclipse.CreateAnalysisAction1">
            <activeWhen>
               <with
                     variable="selection">
                  <and>
                     <count
                           value="1">
                     </count>
                     <or>
                        <iterate
                              ifEmpty="false"
                              operator="or">
                           <test
                                 property="org.eclipse.core.resources.extension"
                                 value="uml">
                           </test>
                        </iterate>
                        <iterate
                              ifEmpty="false"
                              operator="or">
                           <test
                                 property="org.eclipse.core.resources.extension"
                                 value="bpmn2">
                           </test>
                        </iterate>
                        <iterate
                              ifEmpty="false"
                              operator="or">
                           <test
                                 property="org.eclipse.core.resources.extension"
                                 value="bpmn">
                           </test>
                        </iterate>
                        <iterate
                              ifEmpty="false"
                              operator="or">
                           <test
                                 property="org.eclipse.core.resources.extension"
                                 value="owl">
                           </test>
                        </iterate>
                     </or>
                  </and>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="carisma.ui.eclipse.rcp.OpenCarismaPerspectiveHandler"
               commandId="carisma.ui.eclipse.opencarisma">
         </handler>
      </extension>
      <extension
            id="carisma.ui.eclipse.Wizard"
            point="org.eclipse.ui.popupMenus">
         <objectContribution
               id="carisma.ui.eclipse.contribution1"
               objectClass="org.eclipse.core.resources.IFile">
            <menu
                  id="carisma.ui.eclipse.menu1"
                  label="CARiSMA"
                  path="additions">
               <separator
                     name="group1">
               </separator>
            </menu>
         </objectContribution>
      </extension>
      <extension
            point="org.eclipse.ui.bindings">
         <key
               commandId="carisma.ui.eclipse.runanalysisaction"
               contextId="org.eclipse.ui.contexts.window"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="CTRL+R">
         </key>
      </extension>
      <extension
            point="carisma.ui.eclipse.analysis.popup.menu">
            <popupmenu
                  class="carisma.ui.popup.actions.HtmlOutput"/>
            <popupmenu
                  class="carisma.ui.popup.actions.XMLOutput">
            </popupmenu>
      </extension>
      <extension
            id="product"
            point="org.eclipse.core.runtime.products">
         <product
               application="carisma.ui.eclipse.coreapp"
               name="CARiSMA Product">
         </product>
      </extension>

</plugin>
